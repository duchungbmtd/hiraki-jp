<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng Chia ƒê·ªông T·ª´ Ti·∫øng Nh·∫≠t</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
        }

        .search-box input {
            width: 100%;
        }

        .table-container {
            overflow-x: auto;
            max-height: 70vh;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            vertical-align: middle;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .lesson-badge {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .japanese-text {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }

        .kanji-text {
            font-size: 18px;
            color: #e74c3c;
            font-weight: 600;
        }

        .meaning-text {
            color: #27ae60;
            font-weight: 500;
        }

        .difficulty-beginner { border-left: 4px solid #27ae60; }
        .difficulty-intermediate { border-left: 4px solid #f39c12; }
        .difficulty-advanced { border-left: 4px solid #e74c3c; }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #666;
        }

        .stats {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            text-align: center;
            color: #666;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .filter-group select, .filter-group input {
                flex: 1;
                margin-left: 10px;
            }
            
            th, td {
                padding: 8px 5px;
                font-size: 12px;
            }
            
            .japanese-text {
                font-size: 14px;
            }
            
            .kanji-text {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö B·∫£ng Chia ƒê·ªông T·ª´ Ti·∫øng Nh·∫≠t</h1>
            <p>Danh s√°ch ƒë·∫ßy ƒë·ªß c√°c th·ªÉ c·ªßa ƒë·ªông t·ª´ ti·∫øng Nh·∫≠t t·ª´ d·ªØ li·ªáu h·ªçc t·∫≠p</p>
        </div>

        <div class="controls">
            <div class="filter-group">
                <label for="lessonFilter">B√†i h·ªçc:</label>
                <select id="lessonFilter">
                    <option value="">T·∫•t c·∫£ b√†i h·ªçc</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="difficultyFilter">ƒê·ªô kh√≥:</label>
                <select id="difficultyFilter">
                    <option value="">T·∫•t c·∫£ ƒë·ªô kh√≥</option>
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>
            </div>
            
            <div class="filter-group search-box">
                <label for="searchInput">T√¨m ki·∫øm:</label>
                <input type="text" id="searchInput" placeholder="T√¨m theo nghƒ©a, hiragana, kanji...">
            </div>
        </div>

        <div class="table-container">
            <div id="loading" class="loading">
                üîÑ ƒêang t·∫£i d·ªØ li·ªáu...
            </div>
            <table id="verbTable" style="display: none;">
                <thead>
                    <tr>
                        <th style="width: 60px;">STT</th>
                        <th style="width: 80px;">B√†i</th>
                        <th style="width: 120px;">Th·ªÉ t·ª´ ƒëi·ªÉn</th>
                        <th style="width: 120px;">Th·ªÉ „Åæ„Åô</th>
                        <th style="width: 120px;">Th·ªÉ „Å¶</th>
                        <th style="width: 150px;">Nghƒ©a</th>
                        <th style="width: 100px;">Kanji</th>
                    </tr>
                </thead>
                <tbody id="verbTableBody">
                </tbody>
            </table>
        </div>

        <div class="stats" id="stats">
            <span id="totalCount">0</span> ƒë·ªông t·ª´ ƒë∆∞·ª£c t√¨m th·∫•y
        </div>
    </div>

    <script>
        let allVerbs = [];
        let filteredVerbs = [];

        // Logic chia ƒë·ªông t·ª´
        function getDictionaryForm(masuForm) {
            if (!masuForm) return '';
            
            // Lo·∫°i b·ªè "„Åæ„Åô" ho·∫∑c "„Åó„Åæ„Åô"
            if (masuForm.endsWith('„Åó„Åæ„Åô')) {
                return masuForm.slice(0, -3) + '„Åô„Çã';
            } else if (masuForm.endsWith('„Åæ„Åô')) {
                let stem = masuForm.slice(0, -2);
                
                // Nh√≥m 2 (ichidan) - k·∫øt th√∫c b·∫±ng „ÅÑ ho·∫∑c „Åà
                if (stem.endsWith('„ÅÑ') || stem.endsWith('„Åà')) {
                    return stem + '„Çã';
                }
                
                // Nh√≥m 1 (godan) - chuy·ªÉn ƒë·ªïi √¢m cu·ªëi
                const lastChar = stem.slice(-1);
                const conversions = {
                    '„Åç': '„Åè', '„Åé': '„Åê',
                    '„Åó': '„Åô',
                    '„Å°': '„Å§', '„Çä': '„Çã',
                    '„Å´': '„Å¨', '„Å≥': '„Å∂', '„Åø': '„ÇÄ'
                };
                
                if (conversions[lastChar]) {
                    return stem.slice(0, -1) + conversions[lastChar];
                }
                
                // Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát
                if (lastChar === '„ÅÑ') {
                    return stem.slice(0, -1) + '„ÅÜ';
                }
                
                return stem + '„Çã';
            }
            
            return masuForm;
        }

        function getTeForm(dictionaryForm) {
            if (!dictionaryForm) return '';
            
            if (dictionaryForm.endsWith('„Åô„Çã')) {
                return dictionaryForm.slice(0, -2) + '„Åó„Å¶';
            } else if (dictionaryForm.endsWith('Êù•„Çã')) {
                return 'Êù•„Å¶';
            } else if (dictionaryForm.endsWith('Ë°å„Åè')) {
                return dictionaryForm.slice(0, -1) + '„Å£„Å¶';
            } else if (dictionaryForm.endsWith('„Çã')) {
                // Nh√≥m 2
                if (dictionaryForm.length >= 2) {
                    let stem = dictionaryForm.slice(0, -1);
                    let secondLastChar = stem.slice(-1);
                    if (secondLastChar === '„ÅÑ' || secondLastChar === '„Åà') {
                        return stem + '„Å¶';
                    }
                }
                // Nh√≥m 1 v·ªõi „Çã
                return dictionaryForm.slice(0, -1) + '„Å£„Å¶';
            } else if (dictionaryForm.endsWith('„ÅÜ') || dictionaryForm.endsWith('„Å§') || dictionaryForm.endsWith('„Çã')) {
                return dictionaryForm.slice(0, -1) + '„Å£„Å¶';
            } else if (dictionaryForm.endsWith('„ÇÄ') || dictionaryForm.endsWith('„Å∂') || dictionaryForm.endsWith('„Å¨')) {
                return dictionaryForm.slice(0, -1) + '„Çì„Åß';
            } else if (dictionaryForm.endsWith('„Åè')) {
                return dictionaryForm.slice(0, -1) + '„ÅÑ„Å¶';
            } else if (dictionaryForm.endsWith('„Åê')) {
                return dictionaryForm.slice(0, -1) + '„ÅÑ„Åß';
            } else if (dictionaryForm.endsWith('„Åô')) {
                return dictionaryForm.slice(0, -1) + '„Åó„Å¶';
            }
            
            return dictionaryForm + '„Å¶';
        }

        async function loadVerbs() {
            try {
                const response = await fetch('data/all_verbs.json');
                allVerbs = await response.json();
                
                // T·∫°o danh s√°ch b√†i h·ªçc unique
                const lessons = [...new Set(allVerbs.map(v => v.lesson))].sort((a, b) => a - b);
                const lessonFilter = document.getElementById('lessonFilter');
                
                lessons.forEach(lesson => {
                    const option = document.createElement('option');
                    option.value = lesson;
                    option.textContent = lesson === 0 ? 'Introduction' : `Lesson ${lesson}`;
                    lessonFilter.appendChild(option);
                });
                
                filteredVerbs = [...allVerbs];
                displayVerbs();
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('verbTable').style.display = 'table';
                
            } catch (error) {
                console.error('L·ªói khi t·∫£i d·ªØ li·ªáu:', error);
                document.getElementById('loading').innerHTML = '‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu';
            }
        }

        function displayVerbs() {
            const tbody = document.getElementById('verbTableBody');
            tbody.innerHTML = '';
            
            filteredVerbs.forEach((verb, index) => {
                const dictionaryForm = getDictionaryForm(verb.japanese);
                const teForm = getTeForm(dictionaryForm);
                
                const row = document.createElement('tr');
                row.className = `difficulty-${verb.difficulty}`;
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><span class="lesson-badge">${verb.lesson === 0 ? 'Intro' : verb.lesson}</span></td>
                    <td><span class="japanese-text">${dictionaryForm}</span></td>
                    <td><span class="japanese-text">${verb.japanese}</span></td>
                    <td><span class="japanese-text">${teForm}</span></td>
                    <td><span class="meaning-text">${verb.vietnamese}</span></td>
                    <td><span class="kanji-text">${verb.kanji || ''}</span></td>
                `;
                
                tbody.appendChild(row);
            });
            
            document.getElementById('totalCount').textContent = filteredVerbs.length;
        }

        function filterVerbs() {
            const lessonFilter = document.getElementById('lessonFilter').value;
            const difficultyFilter = document.getElementById('difficultyFilter').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            
            filteredVerbs = allVerbs.filter(verb => {
                const matchesLesson = !lessonFilter || verb.lesson == lessonFilter;
                const matchesDifficulty = !difficultyFilter || verb.difficulty === difficultyFilter;
                const matchesSearch = !searchInput || 
                    verb.vietnamese.toLowerCase().includes(searchInput) ||
                    verb.japanese.toLowerCase().includes(searchInput) ||
                    (verb.kanji && verb.kanji.toLowerCase().includes(searchInput));
                
                return matchesLesson && matchesDifficulty && matchesSearch;
            });
            
            displayVerbs();
        }

        // Event listeners
        document.getElementById('lessonFilter').addEventListener('change', filterVerbs);
        document.getElementById('difficultyFilter').addEventListener('change', filterVerbs);
        document.getElementById('searchInput').addEventListener('input', filterVerbs);

        // Load data when page loads
        window.addEventListener('load', loadVerbs);
    </script>
</body>
</html>
